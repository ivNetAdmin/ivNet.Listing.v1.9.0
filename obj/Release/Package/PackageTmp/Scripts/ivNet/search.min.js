var Search = angular.module('ivNet.Search', ['ngResource', 'trNgGrid', 'ngSanitize']);

Search.factory('searchListings', function ($resource) {
    return $resource('/api/listing/search/:id', null,
    {
        'query': { method: 'GET', isArray: true }
    });
});

Search.controller('SearchController', function ($scope, $attrs, searchListings) {

    init();

    function init() {
        $('div#throbber').addClass('throbber-loader');
        $scope.search_fields = ['ImageUrl', 'Description', 'StrapLine', 'Address','Owner', 'Price'];
        searchListings.query({ id: $attrs.search },
            function(data) {
                $scope.listings = data;
                $('div#throbber').removeClass('throbber-loader');
            },
            function(error) {
                alert(error.data.Message + ' [' + error.data.MessageDetail + ']');
                $('div#throbber').removeClass('throbber-loader');
            });
    };
});